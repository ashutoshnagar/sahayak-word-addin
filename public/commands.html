<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sahayak Commands</title>
    
    <!-- Office.js -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
</head>

<body>
    <script>
        // Sahayak Commands - Ribbon integration functions
        
        // Initialize Office.js
        Office.onReady(() => {
            console.log('Sahayak Commands initialized');
        });

        // Function to open Sahayak taskpane
        function openSahayakTaskpane(event) {
            // This function is called when the ribbon button is clicked
            Office.ribbon.requestCreateControls([
                {
                    id: "Sahayak.TaskpaneButton",
                    type: "taskPane",
                    label: "Sahayak Assistant"
                }
            ]);
            
            // Mark the event as completed
            event.completed();
        }

        // Function to scan document directly from ribbon
        function quickScanDocument(event) {
            // Quick scan function that can be called from ribbon
            try {
                if (window.parent && window.parent.sahayakAnalyzer) {
                    window.parent.sahayakAnalyzer.scanDocument();
                } else {
                    // If analyzer not available, show notification
                    Office.ribbon.requestUpdate({
                        tabs: [{
                            id: "TabHome",
                            groups: [{
                                id: "Sahayak.Group1",
                                controls: [{
                                    id: "Sahayak.TaskpaneButton",
                                    enabled: true
                                }]
                            }]
                        }]
                    });
                }
            } catch (error) {
                console.error('Error in quick scan:', error);
            }
            
            // Mark the event as completed
            event.completed();
        }

        // Register functions globally for Office.js
        window.openSahayakTaskpane = openSahayakTaskpane;
        window.quickScanDocument = quickScanDocument;

        // Office.js commands mapping
        Office.actions.associate("openSahayakTaskpane", openSahayakTaskpane);
        Office.actions.associate("quickScanDocument", quickScanDocument);
    </script>
</body>
</html>
